<view class="config-page {{timeBgClass}}">
  <scroll-view scroll-y class="scroll-container">
    
    <!-- 1. å…³ç³»æ°”æ³¡ -->
    <view class="section bubble-section">
      <view class="section-title">ä½ ä»¬ç°åœ¨æ˜¯ï¼Ÿ</view>
      <view class="bubble-container">
        <block wx:for="{{relations}}" wx:key="index">
          <view 
            class="bubble-item {{selectedRelation === index ? 'active' : ''}}" 
            style="animation-delay: {{index * 0.2}}s"
            bindtap="selectRelation" 
            data-index="{{index}}"
          >
            <text class="bubble-text">{{item}}</text>
            <view class="bubble-pop" wx:if="{{selectedRelation === index}}"></view>
          </view>
        </block>
      </view>
    </view>

    <!-- 2. æ—¶é—´é€‰æ‹© -->
    <view class="section time-section">
      <view class="section-title">ä»€ä¹ˆæ—¶å€™å»ï¼Ÿ</view>
      <view class="time-selector">
        <block wx:for="{{times}}" wx:key="index">
          <view class="time-opt {{selectedTime === index ? 'active' : ''}}" bindtap="selectTime" data-index="{{index}}">
            <text class="time-icon">{{item.icon}}</text>
            <text class="time-name">{{item.name}}</text>
          </view>
        </block>
      </view>
    </view>

    <!-- 3. é¢„ç®—é‡‘å¸å † -->
    <view class="section budget-section">
      <view class="section-title">é¢„ç®—å¤šå°‘ç±³ï¼Ÿ</view>
      <view class="money-display">
        <text class="currency">Â¥</text>
        <text class="amount">{{budget}}</text>
      </view>
      
      <view class="money-pile-container">
        <!-- ç®€å•çš„ CSS å †ç§¯æ•ˆæœï¼Œç”¨é‡‘å¸ Emoji é‡å¤å±•ç¤º -->
        <view class="coin-pile" style="height: {{budget / 5000 * 200 + 20}}rpx">
           <text style="word-break: break-all;">{{coinString}}</text>
        </view>
        
        <slider 
          class="budget-slider" 
          min="0" 
          max="5000" 
          step="100" 
          value="{{budget}}" 
          activeColor="#FFD700" 
          backgroundColor="#EEE" 
          block-size="24"
          bindchanging="onBudgetChange"
          bindchange="onBudgetChange"
        />
      </view>
    </view>

    <!-- 4. æ—¶ç©ºé€‰æ‹© -->
    <view class="section space-section">
      <view class="section-title">æ—¶ç©ºåæ ‡</view>
      <view class="space-row">
        <picker mode="date" value="{{date}}" start="2025-01-01" bindchange="bindDateChange">
          <view class="picker-box">
            ğŸ“… {{date}}
          </view>
        </picker>
        <view class="picker-box location-box" bindtap="chooseLocation">
          ğŸ“ {{locationName}}
        </view>
      </view>
    </view>
    
    <view style="height: 150rpx;"></view> <!-- åº•éƒ¨å ä½ -->

  </scroll-view>

  <!-- åº•éƒ¨å¤§æŒ‰é’® -->
  <view class="footer">
    <button class="start-btn" bindtap="submitConfig">
      <text>æŠ•å…¥ç¡¬å¸ï¼Œå¼€å§‹ï¼ğŸª™</text>
    </button>
  </view>
</view>